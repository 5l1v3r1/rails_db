language: ruby

rvm:
  - "1.9.3"
  - "2.0"
  - "2.1"
  - "2.2"
  - ruby-head

gemfile:
  - gemfiles/rails_4_2.gemfile
  - gemfiles/rails_4_1.gemfile
  - gemfiles/rails_4_0.gemfile
  - gemfiles/rails_3_2.gemfile

before_install: gem install bundler

cache: bundler

bundler_args: --without development --jobs=3 --retry=3 --path=../vendor/bundle

env:
  - DB=sqlite
  - DB=mysql
  - DB=postgresql

script:
  - RAILS_ENV=test bundle exec rake db:migrate --trace
  - bundle exec rake db:test:prepare
  - bundle exec rake test

matrix:
  # exclude:
  #   - rvm: 1.9.3
  #     gemfile: gemfiles/active_record_edge.gemfile
  fast_finish: true